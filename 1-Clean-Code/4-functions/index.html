<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>1.4- Funções e métodos - Code Patterns</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "1.4- Fun\u00e7\u00f5es e m\u00e9todos";
        var mkdocs_page_input_path = "1-Clean-Code\\4-functions.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Code Patterns
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Padrões de Código<br></a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">1 Clean Code</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../1-nomenclature/">1.1- Nomenclatura</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2-code-format/">1.2- Formatação do código</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3-flow-control/">1.3- Controle do fluxo</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">1.4- Funções e métodos</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#141-usar-o-dry-dont-repeat-yourselt">1.4.1- Usar o DRY (Don't Repeat Yourselt)  </a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#142-as-funcoes-devem-fazer-apenas-uma-coisa-single-responsability-principle">1.4.2- As funções devem fazer apenas uma coisa (Single Responsability Principle)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#143-limitar-o-numero-de-argumentos-das-funcoes">1.4.3- Limitar o número de argumentos das funções</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#144-usar-parametros-default">1.4.4- Usar parâmetros default</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#145-evitar-efeitos-colaterais-das-funcoes">1.4.5- Evitar efeitos colaterais das funções</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../5-vscode-config/">1.5- Configuração VSCode</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">2 Design Patterns</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../2-Design-Patterns/design-patterns/">Padrões de Design</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Code Patterns</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>1 Clean Code &raquo;</li>
      <li>1.4- Funções e métodos</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="14-funcoes-e-metodos">1.4- Funções e métodos</h1>
<p><br></p>
<hr />
<h3 id="141-usar-o-dry-dont-repeat-yourselt">1.4.1- Usar o DRY (<strong>D</strong>on't <strong>R</strong>epeat <strong>Y</strong>ourselt)  <br></h3>
<p>Código que tem o potencial de ser usado em outros lugares do sistema, ou seja, é genérico, deve ser escrito (encapsulado) dentro de uma função (que poderá, por sua vez, chamar outras funções).<br></p>
<p>Em outras palavras, não escreva o mesmo código ou código muito parecido em mais de um lugar, no sistema. Se ocorrer a necessidade de fazer isso, encapsule tal código em uma função reusável.<br></p>
<p>Isto facilita o entendimento desse código por outros desenvolvedores, incluindo você, no futuro, e facilita a manutenção e expansão futuras desse código.<br>
<br></p>
<hr />
<h3 id="142-as-funcoes-devem-fazer-apenas-uma-coisa-single-responsability-principle">1.4.2- As funções devem fazer apenas uma coisa (Single Responsability Principle)<br></h3>
<p>Note que 'fazer apenas uma coisa', aqui, tem um significado especial. Certamente, a maioria das funções que criamos faz mais de uma coisa, e tais funções não teriam razão de existir não fosse esse fato.<br></p>
<p>Para entendermos o que 'fazer apenas uma coisa' significa, aqui, precisamos explicar um conceito chamado de <em>nível de abstração</em>.<br></p>
<p>Vamos explicar este conceito com uma ilustração concreta.<br>
Imagine que você queira realizar uma tarefa de processar um pagamento, que consista na execução de 100 passos, em sequência.<br>
Como organizaria essa tarefa em JavaScript?<br>
Definiria uma única função, por exemplo <strong>processPayment()</strong>, e executaria os 100 passos dentro dessa função?<br>
Certamente, essa solução não deixaria o código claro, fácil de entender e de manter.<br>
<br>
Uma solução melhor seria:<br></p>
<ol>
<li>Organizar os 100 passos em 20 grupos de aproximadamente 5 passos, cada.</li>
<li>Criar 20 funções adicionais, cada uma para executar os passos dentro de cada um desses 20 grupos. Dizemos, então, que os passos estão no nível 1 de abstração e que as 20 funções que executam cada grupo de passos estão em um nível de abstração superior, que chamamos de nível 2.<br> </li>
<li>Oganizar as 20 funções em 4 novos grupos, com 5 funções do nível 2, em cada um desses 4 grupos.</li>
<li>Criar 4 funções para executar as funções de cada um desses 4 grupos. Agora, podemos dizer que essas 4 novas funções estão no nível 3 de abstração. E, por fim, dizemos que o nível de abstração da função principal, <strong>processPayment()</strong>, é o nível 4 de abstração.<br>
<br></li>
</ol>
<p>Esta ilustração nos permite, então, explicar que: 'fazer apenas uma coisa' significa fazer apenas uma coisa no nível de abstração descrito pelo nome da função. E, portanto, o título desta seção significa que <strong>uma função deve fazer apenas uma coisa no nível de abstração descrito pelo seu nome</strong>.<br></p>
<p>Finalmente, podemos, também, estabelecer mais 2 regras que nos ajudam a organizar, de forma clara, o trabalho a ser feito por meio de funções:</p>
<ol>
<li>O nível de abstração do código, dentro de uma função, deve ser um nível abaixo do nível implícito no nome da função.<br></li>
<li>Deve-se evitar misturar níveis de abstração dentro de funções. Ou seja, qualquer coisa que não se encaixe no nível abaixo do nome, deve ser codificado em outro lugar.<br>
<br></li>
</ol>
<p>Vamos mostrar um exemplo em código para ajudar na compreensão de tudo o que foi dito.<br></p>
<p>Considere a função <strong>renderElement()</strong>, abaixo.<br></p>
<pre><code>function renderElement(dataToRender) {
    const element = dataToRender.element
    if (element === 'script' || element === 'SCRIPT') {
        throw new Error('Invalid element.')
    }

    let partialOpeningTag = '&lt;' + element

    const attributes = dataToRender.attributes

    for (const attribute of attributes) {
        partialOpeningTag = 
            partialOpeningTag + ' ' +
            attribute.name + '="' +
            attribute.value + '"';
    }

    const openingTag = partialOpeningTag + '&gt;'

    const closingTag = '&lt;!--' + element + '--&gt;'
    const content = dataToRender.content

    const template = openingTag + content + closingTag

    const rootElement = dataToRender.root

    rootElement.innerHTML = template
}
</code></pre>
<p><br></p>
<p>Embora o código acima não seja difícil de ler, veja, abaixo, o que acontece quando refactoramos esse código, utilizando os conceitos desta seção:<br></p>
<pre><code>function renderElement(dataToRender) {
    const element = dataToRender.element
    validateElementType(element)

    dataToRender.root.innerHTML = 
        buildOpenningTag(
            element, buildAttributesList(dataToRender.attributes) ) + 
        dataToRender.content + 
        buildClosingTag(element)
}

function validateElementType(element) {
    if (element === 'script' || element === 'SCRIPT') {
        throw new Error('Invalid element.')
    }
}

function buildAttributesList(attributes) {
    let attributeList = ''
    for (const attribute of attributes) {
        attributeList = `${attributeList} ${attribute.name}="${attribute.value}"`
    }
    return attributeList;
}

function buildOpenningTag(element, attributes) {
    return( '&lt;' + element + attributes + '&gt;' )
}

function buildClosingTag(element) {
    return( tag = '&lt;!--' + element + '--&gt;' )
}
</code></pre>
<p><br>
Observe como o comportamento da função <strong>renderElement()</strong>, agora, ficou explícito, fácil de ler e como seu código foi refatorado em 4 funções perfeitamente claras e reusáveis em outras partes do sistema.</p>
<p>Note os níveis de abstração de que falamos anteriormente, no nível 1, temos o conteúdo das funções <strong>buildAttributesList()</strong>, <strong>buildOpenningTag()</strong> e <strong>buildClosingTag()</strong>, no nível 2 temos essas três funções e no nível 3, temos a função <strong>renderElement()</strong>.</p>
<p>Por fim, observe que a atribuição direta da propriedade <strong>dataToRender.root.innerHTML</strong> não atende a regra 2, acima, porque essa atribuição é uma ação que manipula direto o conteúdo do DOM e está mais para algo do nível 1 do que do nível 2.<br>
Nesse caso, entretanto, abrimos uma exceção porque, para resolver isso, teríamos de criar uma função que receberia o elemento <strong>root</strong> e o conteúdo, como parâmetros, para, depois, apenas fazer a atribuição da propriedade <strong>innerHTML</strong>. Ou seja, neste caso, o atendimento da regra 2 acabaria deixando o código poluído e menos claro e, portanto, não vale a pena seguir a regra 2.<br>
<br></p>
<hr />
<h3 id="143-limitar-o-numero-de-argumentos-das-funcoes">1.4.3- Limitar o número de argumentos das funções<br></h3>
<ul>
<li>
<p><strong>Quanto menos argumentos, melhor</strong><br>
A partir de 2 argumentos torna-se necessário mapear cada parâmetro, na chamada da função, a cada argumento da declaração da função. Isto é uma informação implícita que demanda tempo do desenvolvedor. Além disso, o aumento do número de parâmetros aumenta exponencialmente o número de casos de teste para se testar uma função.<br>
<br></p>
</li>
<li>
<p><strong>Usar objetos ou arrays para agrupar múltiplos parâmetros em um único</strong><br>
Caso não seja possível manter apenas 1 ou 2 argumentos, deve-se usar, na chamada da função, um objeto com os mesmos nomes dos argumentos, de modo a tornar explícito o que significa cada parâmetro passado, como no exemplo abaixo.</p>
</li>
</ul>
<p><br></p>
<pre><code>// Bad 😕 
function compare(first, second, comparator) {
    if (comparator === 'equal')         return first === second
    if (comparator === 'not equal')     return first !== second
    if (comparator === 'greater')       return first &gt; second
    if (comparator === 'smaller')       return first &lt; second
}

const isSmaller = compare(3, 5, 'smaller')
const isEqual = compare(3, 5, 'equal')


// Good 😀
function compare(comparisonData) {
    const { first, second, comparator } = comparisonData
    if (comparator === 'equal')         return first === second
    if (comparator === 'not equal')     return first !== second
    if (comparator === 'greater')       return first &gt; second
    if (comparator === 'smaller')       return first &lt; second
}

const isSmaller = compare({ first: 3, second: 5, comparator: 'smaller' })
</code></pre>
<p><br></p>
<ul>
<li><strong>Não usar argumentos como flags</strong><br>
Flags indicam que a função faz mais de uma coisa e, nesse caso, a função deveria ser dividida em 2 ou mais funções.</li>
</ul>
<p><br></p>
<pre><code>// Bad 😕 
function createFile(name, temp) {
    if (temp) {
        fs.create(`./temp/${name}`)
    } else {
        fs.create(name)
    }
}


// Good 😀
function createFile(name) {  fs.create(name)  }
function createTempFile(name) {  createFile(`./temp/${name}`)  }
</code></pre>
<p><br></p>
<hr />
<h3 id="144-usar-parametros-default">1.4.4- Usar parâmetros default<br></h3>
<ul>
<li>Usar argumentos default, quando possível, reduz o número de testes condicionais dentro da função.<br>
<br></li>
</ul>
<hr />
<h3 id="145-evitar-efeitos-colaterais-das-funcoes">1.4.5- Evitar efeitos colaterais das funções<br></h3>
<p>Uma função produz um efeito colateral quando ela envia ou escreve informações em qualquer coisa além de receber parâmetros e retornar valores. Um efeito colateral pode ser, por exemplo, escrever em um arquivo, modificar uma variável global ou modificar um argumento mutável passado como parâmetro, como por exemplo um array ou objeto.</p>
<p>Acessar recursos externos é necessário, como por exemplo acessar um banco de dados. Nestes casos, o que deve ser feito é centralizar onde isso é feito em um conjunto de funções, componente ou serviço designados para tal fim. O acesso ao recurso não deve ser feito de qualquer lugar, sem critério, e deve sempre passar pelos métodos ou funções do Componente ou Serviço designado para isso.</p>
<p>No caso de parâmetros mutáveis, passados como argumentos para uma função, caso seja necessário transformar esse conteúdo passado como parâmetro, o que deve ser feito é criar uma cópia profunda do objeto em questão, transformar tal objeto e retornar a cópia modificada como resultado da função.<br> O resultado de uma função nunca deve ser 'retornado' no objeto passado como parâmetro.<br>
<br></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../3-flow-control/" class="btn btn-neutral float-left" title="1.3- Controle do fluxo"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../5-vscode-config/" class="btn btn-neutral float-right" title="1.5- Configuração VSCode">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../3-flow-control/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../5-vscode-config/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
